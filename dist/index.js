const path=require('path');class CopyPkgJsonPlugin{constructor(a,b=null){('object'!=typeof a||Array.isArray(a))&&(a={}),this.options=a,this.context=b}apply(a){const{options:b,context:c}=this,d=c?require(path.resolve(c,'package.json')):require(path.resolve(a.context,'package.json')),e=JSON.parse(JSON.stringify(d));a.plugin('emit',(f,g)=>{if(b.hasOwnProperty('remove')&&b.remove.forEach((h)=>{if(/\./.test(h)){const j=h.split('.'),k=j.length-1;let l;j.forEach((m,n)=>{0===n?l=e[m]:n===k?delete l[m]:l=l[m]})}else delete e[h]}),b.hasOwnProperty('replace'))for(const h in b.replace)if('object'==typeof b.replace[h]&&e.hasOwnProperty(h))for(const j in b.replace[h])e[h][j]=b.replace[h][j];else e[h]=b.replace[h];f.assets['package.json']={source:()=>JSON.stringify(e,null,'\t'),size:()=>Object.keys(e).length},g()})}}module.exports=CopyPkgJsonPlugin;